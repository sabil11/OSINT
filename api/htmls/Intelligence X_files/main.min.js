'use strict';var kleissner=kleissner||{};kleissner.localApiCalls=(function($){var
getOrders,getAlerts,callAction,checkStats,init;getOrders=function getOrders(){$.get('/order_list',{},function(data){try{data=JSON.parse(data);var editedData=[];$.each(data,function(key,value){editedData[key]=[];editedData[key]['type']=value['license']=='professional'?'Professional':'';editedData[key]['placed']=moment(value['placed']).format('YYYY-MM-DD hh:mm:ss');editedData[key]['updated']=moment(value['updated']).format('YYYY-MM-DD hh:mm:ss');editedData[key]['status']=value['status'];editedData[key]['expiry']=value['expires']+' Days';editedData[key]['price']=value['amount'];editedData[key]['currency']=value['currency']==0?'EUR':'USD';switch(value['processor']){case 0:editedData[key]['method']='CoinGate';break;case 1:editedData[key]['method']='PayPal';break;case 2:editedData[key]['method']='Bank Wire';break;}});$('#ordersTable').bootstrapTable({data:editedData});}catch(e){$('#ordersTable').bootstrapTable({data:[]});}});};getAlerts=function getAlerts(){$.get('/alert_list',{},function(data){try{data=JSON.parse(data);var editedData=[];$.each(data,function(key,value){value['name']=escapeHtml(value['name']);value['selector']=escapeHtml(value['selector']);value['email']=escapeHtml(value['email']);value['frequency']=escapeHtml(value['frequency']);editedData[key]=[];editedData[key]['name']=value['name'];editedData[key]['selector']=value['selector'];editedData[key]['email']=value['email'];editedData[key]['frequency']=value['frequency'];editedData[key]['added']=moment(value['added']).format('YYYY-MM-DD hh:mm:ss');editedData[key]['updated']=moment(value['updated']).format('YYYY-MM-DD hh:mm:ss');editedData[key]['action']='<a href="#" class="alertEdit" data-id="'+value['alertid']+'" data-name="'+value['name']+'" data-selector="'+value['selector']+'" data-email="'+value['email']+'" data-frequency="'+value['frequency']+'" data-toggle="modal" data-target="#alertModal" data-backdrop="static" data-keyboard="false" title="Edit"><i class="fa fa-edit"></i></a>';editedData[key]['action']+='<a href="#" class="alertDelete" data-id="'+value['alertid']+'" data-title="'+value['id']+'" style="margin-left: 1em" title="Delete"><i class="fa fa-trash"></i></a>';editedData[key]['action']+='<a href="#" class="alertPreview" data-toggle="modal" data-target="#alertPreviewModal" data-id="'+value['alertid']+'" style="margin-left: 1em" title="Preview"><i class="fa fa-eye"></i></a>';});$('#alertsTable').bootstrapTable({data:editedData});$('#alertsTable').bootstrapTable('load',{data:editedData});}catch(e){$('#alertsTable').bootstrapTable({data:[]});}});};callAction=function callAction(request,formAction,callback){if(typeof callback=='undefined'){callback=kleissner.localHandler.renderFormMessages;}else if(callback=='settingsInputCallback'){callback=kleissner.localHandler.settingsInputCallback;}else if(callback=='editEmailCallback'){callback=kleissner.localHandler.editEmailCallback;}else if(callback=='deleteAccountCallback'){callback=kleissner.localHandler.deleteAccountCallback;}else if(callback=='redeemLicenceCallback'){callback=kleissner.localHandler.redeemLicenceCallback;}else if(callback=='alertInputCallback'){callback=kleissner.localHandler.alertInputCallback;}
$.post(formAction,request,callback);};checkStats=function checkStats(pl_ID,callback){var request=$.ajax({url:API_URL+"intelligent/search/statistic",type:"GET",cache:true,data:"id="+pl_ID+'&k='+API_KEY,success:function(data,textStatus,xhr){kleissner.frontendChanges.generateStats(data,pl_ID);heatmapData=data;var keys=Object.keys(heatmapData.heatmap);var helper=[false,false];var startYear,endYear;for(var i=0;i<keys.length;i++){if(keys[i]>=0&&helper[0]==false){startYear=keys[i];helper[0]=true}
if(keys[keys.length-1-i]>=0&&helper[1]==false){endYear=keys[keys.length-1-i];helper[1]=true}
if(helper[0]&&helper[1]){break;}}
startYear=new Date(parseInt(startYear)*1000).getUTCFullYear();endYear=new Date(parseInt(endYear)*1000).getUTCFullYear();var arr=[];for(var i=startYear;i<=endYear;i++){arr[i]=[]
var daysInMonth=[31,new Date(Date.UTC(i,1,29)).getDate()===29?29:28,31,30,31,30,31,31,30,31,30,31];for(var j=0;j<daysInMonth.length;j++){arr[i][j]=[]
for(var k=0;k<daysInMonth[j];k++){arr[i][j][k]=0;}}}
for(var index in heatmapData.heatmap){if(index>0){var date=new Date(parseInt(index)*1000);arr[date.getUTCFullYear()][date.getUTCMonth()][date.getUTCDate()-1]+=parseInt(heatmapData.heatmap[index]);}}
heatmapData.heatmap=arr;kleissner.frontendChanges.refreshGraphs();if(typeof callback==='function'){callback();}
if(data.terminated){return;}
if(xhr.status==204){setTimeout(function(){checkStats(pl_ID);},2000);}else{if(!!data){setTimeout(function(){checkStats(pl_ID);},2000);}}},error:kleissner.frontendChanges.onStatsError(pl_ID)});};init=function(){};$(document).ready(init);return{getOrders:getOrders,getAlerts:getAlerts,callAction:callAction,checkStats:checkStats};}($));'use strict';var kleissner=kleissner||{};kleissner.localHandler=(function($){var
collapseOnClick,confirmDeleteOnClick,deleteOnClick,deleteAccountCallback,editEmailOnClick,editEmailCallback,licenseBtnOnClick,redeemLicenceCallback,formDisableEnter,licenseResetOnClick,nav1ItemOnClick,submitFormToAction,alertDelete,alertEdit,alertPreview,settingsInputCallback,alertInputCallback,renderFormMessages,newsletterButtonOnClick,isDetailFullscreen,detailFullScreenOnClick,detailFullScreenRemove,printOnClick,inputOnBlur,inputOnClick,inputOnFocus,logoOnClick,redactedLoginOnClick,heatmapButtonsOnClick,passwordOnInput,usernameOnInput,paymentChoiceOnClick,paymentOptionOnClick,redeemDiscountOnClick,PBButtonOnClick,servicesContainerOnMouseLeave,servicesContainerOnMouseEnter,servicesContainerOnWheel,addressOnInput,captchaOnInput,countryOnInput,firstNameOnInput,termsOnChange,chartOverlayOnClick,openChartModalOnClick,collapseButtonOnClick,collapseAllButtonOnClick,init;collapseOnClick=function collapseOnClick(event){event.preventDefault();var id=$(this).attr('href');$('.collapse').not(id).removeClass('in');if($(id).hasClass('in')){$(id).removeClass('in');window.history.replaceState({page:'account',tab:!!window.history.state&&!!window.history.state.tab?window.history.state.tab:''},null);}else{$(id).addClass('in');window.history.replaceState({page:'account',tab:!!window.history.state&&!!window.history.state.tab?window.history.state.tab:'',update:$(this).attr('href')},null);}};confirmDeleteOnClick=function confirmDeleteOnClick(event){kleissner.localApiCalls.callAction($('#delete_account').serialize(),'/delete_account','deleteAccountCallback');};deleteAccountCallback=function deleteAccountCallback(data){kleissner.localHandler.renderFormMessages(data);if(data.result){window.location.replace('/');}
$('#deleteModal').modal('hide');};deleteOnClick=function deleteOnClick(event){event.preventDefault();$('#deleteModal').modal('show');};editEmailOnClick=function editEmailOnClick(event){var parent=$(this).parent();var text=parent.find('span').html();$('#username_form_username').show();$('#username_form_username').focus();$('#settings_username span').hide();$('#settings_username a').hide();$('#username_form_username').on('blur',function(){kleissner.localApiCalls.callAction($('#username_form').serialize(),'/update_username','editEmailCallback');});};editEmailCallback=function editEmailCallback(data){kleissner.localHandler.renderFormMessages(data);if(data.result){$('#username_form_username').val(data.userdata.username);$('#username_form_username').hide();$('#settings_username span').html(data.userdata.username);$('#settings_username span').show();$('#settings_username a').show();$('#username_form_success_messages').delay(4000).fadeOut(500);}};licenseBtnOnClick=function licenseBtnOnClick(event){$('#licenseCurrent').val($(this).val());$(this).closest('form').submit();};redeemLicenceCallback=function redeemLicenceCallback(data){kleissner.localHandler.renderFormMessages(data);if(data.result){if(data.action=='accountUpdated'){window.location.replace('/account?tab=overview');}else{$('#licenseRedeemBtn').hide().siblings('input').show();$('#redeem_license_discount_code').css({'background-color':'lightgray','font-style':'italic'}).prop('readonly',true);$('#applyLicenseTable').remove();$('#redeem_license').parent().append('<table id="applyLicenseTable">'+
'<tr>'+
'<td>License: </td>'+
'<td>'+data.title+'</td>'+
'</tr>'+
'<tr>'+
'<td>Valid For: </td>'+
'<td>'+data.days+' Days</td>'+
'</tr>'+
'</table>');}}};formDisableEnter=function formDisableEnter(event){if(event.keyCode==13){event.preventDefault();}};licenseResetOnClick=function licenseResetOnClick(event){$('#applyLicenseTable').remove();$('#redeem_license_discount_code').css({'background-color':'#fff','font-style':'normal'}).prop('readonly',false).val('');$('.licenseBtn').hide();$(this).hide();$('#licenseRedeemBtn').show();};nav1ItemOnClick=function nav1ItemOnClick(event){window.history.pushState({page:'account',tab:$(this).attr('data-tab')},null,'./account?tab='+$(this).attr('data-tab'));};renderFormMessages=function renderFormMessages(data){if(!!data){$('#'+data.name+" > .alert").hide();$('#'+data.name).find(".invalid-feedback").hide();if(data.result){if(typeof data.formMessages[0]!='undefined'){$('#'+data.name+'_success_messages').html(data.formMessages[0]).show();}}else{if(!!data.formMessages){for(var i=0;i<data.formMessages.length;i++){var emptyAlert=$('#'+data.name+'_alert_messages');if(i>0){$(emptyAlert).after($(emptyAlert).clone().html(data.formMessages[i]).show());}else{$(emptyAlert).show();$(emptyAlert).html(data.formMessages[i]);}}}
$.each(data.elementMessages,function(id,message){if(message!=null){$('#'+id).after('<div class="invalid-feedback is-invalid">'+message+'</div>');}});}}};newsletterButtonOnClick=function newsletterButtonOnClick(event){event.preventDefault();var button=$(this);$('#newsletterMsg').remove();$.post('/toggle_newsletter',function(data){var result=JSON.parse(data);if(result.success){if(result.active){button.html('Unsubscribe from Newsletter');button.after('<div id="newsletterMsg" style="color:green; font-size:0.8rem; margin-top: 5px;">Successfully subscribed to newsletter!</div>');}else{button.html('Subscribe to Newsletter');button.after('<div id="newsletterMsg" style="color:green; font-size:0.8rem; margin-top: 5px;">Successfully unsubscribed from newsletter!</div>');}}else{button.after('<div id="newsletterMsg" style="color:red; font-size:0.8rem; margin-top: 5px;">An unexpected error has occured. Please try again later.</div>');}
setTimeout(function(){$('#newsletterMsg').remove();},2000);});};settingsInputCallback=function settingsInputCallback(data){renderFormMessages(data);if(data.result){$.each(data.userdata,function(index,value){$('#settings_'+index+' span').html(value);});}};alertInputCallback=function alertInputCallback(data){renderFormMessages(data);if(data.result){$('#alertModal').modal('hide');kleissner.localApiCalls.getAlerts();$('#alert_form_success_messages').delay(5000).fadeOut(1000);}};submitFormToAction=function submitFormToAction(event){event.preventDefault();var formData=$(event.target).serializeArray();formData[formData.length]={'name':$(document.activeElement)[0].name,'value':$(document.activeElement)[0].value};kleissner.localApiCalls.callAction(formData,$(event.target).attr('action'),$(event.target).data('callback'));};alertDelete=function alertDelete(event){event.preventDefault();if(confirm('Are you sure to delete the alert?')){$('#delete_alert_form_id').val($(event.target).parent('a').data('id'));$('#delete_alert_form').submit();}}
alertEdit=function alertEdit(){event.preventDefault();$('#alert_edit_form_name').val($(event.target).parent('a').data('name'));$('#alert_edit_form_selector').val($(event.target).parent('a').data('selector'));$('#alert_edit_form_email').val($(event.target).parent('a').data('email'));$('#alert_edit_form_id').val($(event.target).parent('a').data('id'));$('#alert_edit_form_frequency option').removeAttr("selected");$('#alert_edit_form_frequency option:contains('+$(event.target).parent('a').data('frequency')+')').attr('selected','selected');$('#alert_edit_form > .alert').hide();$('#alert_edit_form').find(".invalid-feedback").hide();}
alertPreview=function alertPreview(){event.preventDefault();$('#alertPreviewAlert').hide();$('#alertPreviewTarget').html('');$('#alertPreviewModal').find('.loader').show();$('#alertPreviewTarget').hide();$('#alertPreviewTarget').load('/alertpreview','id='+$(event.target).parent('a').data('id'),function(data){if(data==''){$('#alertPreviewAlert').html('No preview available');$('#alertPreviewAlert').show();}else{var doc=document.getElementById('alertPreviewTarget').contentWindow.document;doc.open();doc.write(data);doc.close();$('#alertPreviewTarget').show();}
$('#alertPreviewModal').find('.loader').hide();});}
isDetailFullscreen=function isDetailFullscreen(){return null!==(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement||null)&&$('#toggleFullscreen').find("i").hasClass('fa-compress');};detailFullScreenOnClick=function detailFullScreenOnClick(event){event.preventDefault();var elem=document.documentElement;if(!isDetailFullscreen()){if(elem.requestFullscreen){elem.requestFullscreen();}else if(elem.msRequestFullscreen){elem.msRequestFullscreen();}else if(elem.mozRequestFullScreen){elem.mozRequestFullScreen();}else if(elem.webkitRequestFullscreen){elem.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT);}
$('#toggleFullscreen').find("i").removeClass("fa-expand").addClass("fa-compress");$('#detail_overlay').addClass('fullscreen');$('#detail_overlay .modal-dialog').addClass('fullscreen');$('#data_full').addClass('fullscreen');$('#data_special_tab').addClass('fullscreen');$('#data_index_tab').addClass('fullscreen');$('#data_history_tab').addClass('fullscreen');}else{detailFullScreenRemove(event);}};detailFullScreenRemove=function detailFullScreenRemove(){if(isDetailFullscreen()){if(document.exitFullscreen){document.exitFullscreen();}else if(document.msExitFullscreen){document.msExitFullscreen();}else if(document.mozCancelFullScreen){document.mozCancelFullScreen();}else if(document.webkitExitFullscreen){document.webkitExitFullscreen();}
$('#toggleFullscreen').find("i").removeClass("fa-compress").addClass("fa-expand");$('#detail_overlay').removeClass('fullscreen');$('#detail_overlay .modal-dialog').removeClass('fullscreen');$('#data_full').removeClass('fullscreen');$('#data_special_tab').removeClass('fullscreen');$('#data_index_tab').removeClass('fullscreen');$('#data_history_tab').removeClass('fullscreen');}};printOnClick=function printOnClick(event){var winPrint=window.open('','','left=0,top=0,width=800,height=600,toolbar=0,scrollbars=0,status=0');var redactedWarning="";if(detailsPrint.accesslevel==4){if(API_LEVEL.indexOf("public")!=-1){redactedWarning='<div>'+
'<p>'+
'Signup or Login to view redacted documents.'+
'</p>'+
'</div>';}else{redactedWarning='<div>'+
'<p>Upgrade your License to view redacted documents.</p>'+
'</div>';}}
var keyValues="";if(!!detailsPrint.keyvalues){for(var i=0;i<detailsPrint.keyvalues.length;i++){keyValues+='<tr>'+
'<td style="width: 25%;">'+detailsPrint.keyvalues[i].key+'</td>'+
'<td style="width: 75%;word-wrap: break-word;">'+detailsPrint.keyvalues[i].value+'</td>'+
'</tr>';}}
var script="";if(!!detailsPrint['iframe']){}
var html='<html>'+
'<head>'+
script+
'</head>'+
'<body style="font-family: Menlo,Monaco,Consolas,\'Courier New\',monospace;">'+
'<div style="width: 180px"><img src="/assets/img/IntelligenceX.svg" /></div>'+
'<div>'+
'<h4 id="main_name" style="margin-top:20px;">'+detailsPrint.name+'</h4>'+
'<div>'+
'<table class="table table-condensed" style="table-layout: fixed;width: 100%;font-size: 14px;">'+
'<tbody>'+
'<tr>'+
'<td style="width: 25%;">Title</td>'+
'<td style="width: 75%;word-wrap: break-word;">'+detailsPrint.name+'</td></tr>'+
'<tr>'+
'<td style="width: 25%;">Date</td>'+
'<td style="width: 75%;word-wrap: break-word;">'+detailsPrint.date+'</td>'+
'</tr>'+
'<tr>'+
'<td style="width: 25%;">Media</td>'+
'<td style="width: 75%;word-wrap: break-word;">'+detailsPrint.mediah+'</td>'+
'</tr>'+
keyValues+
'</tbody>'+
'</table>'+
'<h5>Technical internal data for the record: </h5>'+
'<table class="table table-condensed" style="table-layout: fixed;width: 100%;font-size: 14px;">'+
'<tbody>'+
'<tr>'+
'<td style="width: 25%;">System ID</td>'+
'<td style="width: 75%;word-wrap: break-word;">'+detailsPrint.systemid+'</td>'+
'</tr>'+
'<tr>'+
'<td style="width: 25%;">Storage ID</td>'+
'<td style="width: 75%;word-wrap: break-word;">'+detailsPrint.storageid+'</td>'+
'</tr>'+
'<tr>'+
'<td style="width: 25%;">Simhash</td>'+
'<td style="width: 75%;word-wrap: break-word;">'+detailsPrint.simhashh+'</td>'+
'</tr>'+
'<tr>'+
'<td style="width: 25%;">Type</td>'+
'<td style="width: 75%;word-wrap: break-word;">'+detailsPrint.typeh+'</td>'+
'</tr>'+
'<tr>'+
'<td style="width: 25%;">Size</td>'+
'<td style="width: 75%;word-wrap: break-word;">'+detailsPrint.size+' Bytes</td>'+
'</tr>'+
'</tbody>'+
'</table>'+
'</div>'+
redactedWarning+
'<pre id="content"></pre>'+
'<h5 style="margin-top:50px;">'+
'<hr>'+
'Disclaimer: Intelligence X finds information in public electronic records. '+
'It does not validate or vet any of the above information.'+
'</h5>'+
'</body>'+
'</html>';winPrint.document.write(html);if(!!detailsPrint['iframe']){$(winPrint.document).find('#content').append('Print of Inline website copy is not supported');winPrint.document.close();winPrint.focus();winPrint.print();winPrint.close();}else{$(winPrint.document).find('#content').append(detailsPrint.raw);winPrint.document.close();winPrint.focus();winPrint.print();winPrint.close();}};inputOnBlur=function inputOnBlur(event){$(this).prop('readonly','readonly');};inputOnClick=function inputOnClick(event){$(this).prop('readonly','');$(this).focus();};inputOnFocus=function inputOnFocus(event){$(this).prop('readonly','');$(this).focus();};logoOnClick=function logoOnClick(event){event.preventDefault();$('#clear_filters').trigger('click');if(!!window.history.state&&!!window.history.state.form){window.history.pushState({page:'index'},null,'./');}
document.location.href="/";};redactedLoginOnClick=function redactedLoginOnClick(event){event.preventDefault();$('#close-detail-view').trigger('click');};heatmapButtonsOnClick=function heatmapButtonsOnClick(event){if(typeof heatmapData.heatmap==='undefined'||heatmapData.heatmap.length===0){return;}
var parent=$('#heatmapContainer').parent();$('#heatmapContainer').remove();parent.append('<svg id="heatmapContainer"></svg>');var selectedYear=parseInt($(this).attr('data-year'));if(!heatmapData.heatmap[selectedYear-1]){$('#heatmapPrevious').css('display','none');}else{$('#heatmapPrevious').css('display','block');$('#heatmapPrevious').attr('data-year',selectedYear-1);}
if(!heatmapData.heatmap[selectedYear+1]){$('#heatmapNext').css('display','none');}else{$('#heatmapNext').css('display','block');$('#heatmapNext').attr('data-year',selectedYear+1);}
var data=heatmapData.heatmap[selectedYear];$('#heatmapContainer').parent().attr('data-year',selectedYear);var helper=[]
for(var i=0;i<data.length;i++){for(var j=0;j<data[i].length;j++){var date=new Date(Date.UTC(selectedYear,i,j+1));var month=date.getMonth()+1<10?'0'+(date.getMonth()+1):date.getMonth()+1
var day=date.getDate()<10?'0'+date.getDate():date.getDate()
helper.push({date:date,value:data[i][j],selector:date.getFullYear()+'-'+month+'-'+day})}}
createHeatmap($('#heatmapContainer'),helper,'date');};passwordOnInput=function passwordOnInput(event){var input=$(this);var is_password=input.val();if(!!is_password){input.removeClass("is-invalid").addClass("is-valid");}else{input.removeClass("is-valid").addClass("is-invalid");}};usernameOnInput=function usernameOnInput(event){var input=$(this);var is_name=input.val();if(!!is_name&&isValidEmailAddress(is_name)){input.removeClass("is-invalid").addClass("is-valid");}else{input.removeClass("is-valid").addClass("is-invalid");}};paymentChoiceOnClick=function paymentChoiceOnClick(){$('.paymentChoiceInput[type=radio]').attr('checked',false);var radio=$(this).find('.paymentChoiceInput[type=radio]');radio.prop('checked',true);};paymentOptionOnClick=function paymentOptionOnClick(){$('.paymentOptionInput[type=radio]').attr('checked',false);var radio=$(this).find('.paymentOptionInput[type=radio]');radio.prop('checked',true);var days=radio.val();$.get('/payment_get_price',{days:days},function(data){if(!!data){var price=data;if(!!$('#currentDiscount').attr('data-discount')){var discount=$('#currentDiscount').attr('data-discount');price=data*(100-discount)/100;}
$('#regular_price').attr('data-original-price',data).attr('data-price',price).html('€ '+price);}});};redeemDiscountOnClick=function redeemDiscountOnClick(event){event.preventDefault();var discountCode=$('#discount_input').val();$.get('/payment_get_discount_code',{discountCode:discountCode},function(data){if(!!data){$('#discountLabel').html('<div class="text-success">'+
'<h6 class="my-0">Promo code</h6>'+
'<small>'+discountCode+'</small>'+
'</div>'+
'<span class="text-success" id="currentDiscount" data-discount="'+data+'">- '+data+'%</span>').css('display','flex');var priceEl=$('#regular_price');var price=priceEl.attr('data-original-price')*(100-data)/100;priceEl.attr('data-price',priceEl.attr('data-original-price')-data).html('€ '+price);$('#apply_discount').val(discountCode);}else{$('#discountLabel').html('<div><h6 class="my-0">Promo code not found</h6></div>').css('display','flex');}});};PBButtonOnClick=function PBButtonOnClick(){var serviceContainer=$('#services_container');$('.PBButton').toggle();serviceContainer.toggleClass('collapsed');if(serviceContainer.hasClass('collapsed')){serviceContainer.children('#serviceHeader').css('top',serviceContainer.scrollTop()+'px');}else{serviceContainer.children('#serviceHeader').css('top',0);}};servicesContainerOnMouseLeave=function servicesContainerOnMouseLeave(){isOverServices=false;};servicesContainerOnMouseEnter=function servicesContainerOnMouseEnter(){isOverServices=true;};servicesContainerOnWheel=function servicesContainerOnWheel(event){if(isOverServices){var container=$('#services_container');var e=event.originalEvent;if(e.deltaY>0){if(container[0].scrollHeight-container.scrollTop()>container.outerHeight()){event.preventDefault();container.scrollTop(container.scrollTop()+e.deltaY);container.children('#serviceHeader').css('top',container.scrollTop()+'px');container.children('#PBExpand').css('bottom',-container.scrollTop()+15+'px');}}else{if(container.scrollTop()>0){event.preventDefault();container.scrollTop(container.scrollTop()+e.deltaY);container.children('#serviceHeader').css('top',container.scrollTop()+'px');container.children('#PBExpand').css('bottom',-container.scrollTop()+15+'px');}}}};addressOnInput=function addressOnInput(event){var input=$(this);var is_address=input.val();if(!!is_address){input.removeClass("is-invalid").addClass("is-valid");}else{input.removeClass("is-valid").addClass("is-invalid");}};captchaOnInput=function captchaOnInput(event){var input=$(this);var is_captcha=input.val();if(!!is_captcha){input.removeClass("is-invalid").addClass("is-valid");}else{input.removeClass("is-valid").addClass("is-invalid");}};countryOnInput=function countryOnInput(event){var input=$(this);var is_country=input.val();if(!!is_country){input.removeClass("is-invalid").addClass("is-valid");}else{input.removeClass("is-valid").addClass("is-invalid");}};firstNameOnInput=function firstNameOnInput(event){var input=$(this);var is_firstName=input.val();if(!!is_firstName){input.removeClass("is-invalid").addClass("is-valid");}else{input.removeClass("is-valid").addClass("is-invalid");}};termsOnChange=function termsOnChange(event){if(!!$(this).is(':checked')){$(this).removeClass("is-invalid");}else{$(this).addClass("is-invalid");}};chartOverlayOnClick=function chartOverlayOnClick(event){if(event.target===this){$('#chartModal .close').click();}};openChartModalOnClick=function openChartModalOnClick(toggle){var container=$('#stats_chart');if(toggle){container.hide();$('#search_stats').find('span').show();}else{container.show();$('#search_stats').find('span').hide();}
$('#chartsIsOpen').toggleClass('fa-caret-down fa-caret-up');};collapseButtonOnClick=function collapseButtonOnClick(event){event.preventDefault();if($(this).hasClass('plus')){$(this).html('<i class="fa fa-minus-square-o"></i>');$(this).toggleClass('plus minus').closest('.search-result').find('.result').removeClass('hidden');$(this).closest('.searchDataContainer').find('.collapseAllButton').addClass('minus').removeClass('plus').html('Group all');}else if($(this).hasClass('minus')){$(this).html('<i class="fa fa-plus-square-o"></i>');$(this).toggleClass('plus minus').closest('.search-result').find('.result').addClass('hidden');if($(this).closest('.searchDataContainer').find('.result').length-1==$(this).closest('.searchDataContainer').find('.hidden').length){$(this).closest('.searchDataContainer').find('.collapseAllButton').addClass('plus').removeClass('minus').html('Ungroup all');}}};collapseAllButtonOnClick=function collapseAllButtonOnClick(event){event.preventDefault();if($(this).hasClass('plus')){$(this).html('Group all');$(this).closest('.searchDataContainer').find('.collapseButton').addClass('minus').removeClass('plus').html('<i class="fa fa-minus-square-o"></i>');$(this).closest('.searchDataContainer').find('.result:not(:first)').removeClass('hidden');}else if($(this).hasClass('minus')){$(this).html('Ungroup all');$(this).closest('.searchDataContainer').find('.collapseButton').addClass('plus').removeClass('minus').html('<i class="fa fa-plus-square-o"></i>');$(this).closest('.searchDataContainer').find('.result:not(:first)').addClass('hidden');}
$(this).toggleClass('plus minus');};init=function init(){$(document).on('click','.collapseLink',collapseOnClick);$(document).on('click','#confirmDelete',confirmDeleteOnClick);$(document).on('click','#deleteAcc',deleteOnClick);$(document).on('click','#editEmail',editEmailOnClick);$(document).on('keypress','#settings form',formDisableEnter);$(document).on('click','#licenseResetBtn',licenseResetOnClick);$(document).on('click','.licenseBtn',licenseBtnOnClick);$(document).on('click','.nav1',nav1ItemOnClick);$(document).on('submit','.xhrform',submitFormToAction);$(document).on('click','.alertDelete',alertDelete);$(document).on('click','.alertEdit',alertEdit);$(document).on('click','.alertPreview',alertPreview);if(window.location.href.indexOf("account")>-1){$(document).ready(function(){kleissner.apiCalls.getAuthenticateInfo();});}
$(document).on('click','#newsletterButton',newsletterButtonOnClick);$(document).on('click','#ix_logo, #homeLink',logoOnClick);$(document).on('click','#redacted_login',redactedLoginOnClick);$(document).on('click','.heatmapButtons',heatmapButtonsOnClick);$(document).on('input','#password',passwordOnInput);$(document).on('input','#username',usernameOnInput);$(document).on('click','.paymentChoice',paymentChoiceOnClick);$(document).on('click','.paymentOption',paymentOptionOnClick);$(document).on('click','#redeemDiscount',redeemDiscountOnClick);$(document).on('click','.PBButton',PBButtonOnClick);$(document).on('mouseleave','#services_container',servicesContainerOnMouseLeave);$(document).on('mouseenter','#services_container',servicesContainerOnMouseEnter);$('#services_container').on("mousewheel",servicesContainerOnWheel);$(document).on('click','#chartModal',chartOverlayOnClick);$(document).on('click','#chartModalOpen, #chartsIsOpen, #stats_line',function(event){event.preventDefault();openChartModalOnClick($('#stats_chart').is(':visible'));});$(document).on('click','#chartModal .close',function(event){event.preventDefault();window.history.go(-1);});$(document).on('click',"#close-detail-view",function(event){event.preventDefault();window.history.go(currentHistoryIndex-window.history.length-1);});$(document).on('click','#toggleFullscreen',detailFullScreenOnClick);$(document).on('click','#close-detail-view',detailFullScreenRemove);$(document).on('click','.collapseButton',collapseButtonOnClick);$(document).on('click','.collapseAllButton',collapseAllButtonOnClick);$(document).on('input','#address',addressOnInput);$(document).on('input','#captcha',captchaOnInput);$(document).on('input','#country',countryOnInput);$(document).on('input','#firstName',firstNameOnInput);$(document).on('input','#signup_password',passwordOnInput);$(document).on('input','#signup_username',usernameOnInput);$(document).on('change','#terms',termsOnChange);};$(document).ready(init);return{settingsInputCallback:settingsInputCallback,alertInputCallback:alertInputCallback,redeemLicenceCallback:redeemLicenceCallback,editEmailCallback:editEmailCallback,deleteAccountCallback:deleteAccountCallback,renderFormMessages:renderFormMessages,submitFormToAction:submitFormToAction,alertEdit:alertEdit,alertPreview:alertPreview,printOnClick:printOnClick,openChartModalOnClick:openChartModalOnClick}}($));'use strict';var kleissner=kleissner||{};kleissner.frontendChanges=(function($){var
onToggleFilter,autoTogglePBButton,hideWarnings,toggleDownload,toggleHeader,toggleSearch,refreshGraphs,appendSearchResultPB,onResultsErrorPB,generateStats,onStatsError,appendSearchError,appendSearchResult,changeSearchMessage,changeSearchMessagePB,onResultsError,onSearch,onSearchEnd,onSearchError,init;onToggleFilter=function onToggleFilter(event){$(this).parent().find('.activeFilter').not($(this)).removeClass('activeFilter')
$(this).toggleClass('activeFilter');var tab=$('#tab');tab.html('');var filtersEl=$('.activeFilter');var date=null,bucket=null,media=null,reset=null;var hasEl=false;filtersEl.each(function(ix,element){if($(element).attr('data-type')=='date'){date=$(element).attr('data-date');hasEl=true;}else if($(element).attr('data-type')=='bucket'){bucket=$(element).attr('data-value');hasEl=true;}else if($(element).attr('data-type')=='media'){media=$(element).attr('data-value');hasEl=true;}});if(!hasEl){reset=1;}
kleissner.apiCalls.checkResults(tab.attr("search-id"),tab.attr("search-term"),10,Number(tab.attr("groupUp")),tab.attr("alt-term"),tab.attr("alt-termh"),0,bucket,media,date,date,reset);};autoTogglePBButton=function autoTogglePBButton(){var container=$('#services_container');container.addClass('collapsed');container.find('.PBButton').hide();if(container[0].scrollHeight>container.height()){container.find('#PBExpand').show();}};hideWarnings=function hideWarnings(){$('.warning').hide();};toggleDownload=function toggleDownload(toggle){if(toggle){$("#download_all").show();$("#download_all_zip").show();}else{$("#download_all").hide();$("#download_all_zip").hide();}};toggleSearch=function toggleSearch(toggle){$('#Term').prop('disabled',!toggle);$('#btnSearch').prop('disabled',!toggle);};toggleHeader=function toggleHeader(toggle){if(toggle){$("#main_search_container").css("margin-top","100px");$("#main_search_container_header").show();$(".jumbotron").css("padding-bottom","4rem");}else{$("#main_search_container").css("margin-top","0px");$("#main_search_container_header").hide();$(".jumbotron").css("padding-bottom","0");}};refreshGraphs=function refreshGraphs(){if(typeof heatmapData.heatmap==='undefined'||heatmapData.heatmap.length===0){return;}
var heatmapContainerParent=$('#heatmapContainer').parent();$('#heatmapContainer').remove();heatmapContainerParent.append('<svg id="heatmapContainer"></svg>');var pieChartContainerParent=$('#pieChartContainer').parent();$('#pieChartContainer').remove();pieChartContainerParent.find('.chartLegend').remove();pieChartContainerParent.append('<svg id="pieChartContainer" style="padding: 0;"></svg>');var pieChartContainer2Parent=$('#pieChartContainer2').parent();$('#pieChartContainer2').remove();pieChartContainer2Parent.find('.chartLegend').remove();pieChartContainer2Parent.append('<svg id="pieChartContainer2" style="padding: 0;"></svg>');var selectedYear=!!$('#heatmapContainer').parent().attr('data-year')?Number($('#heatmapContainer').parent().attr('data-year')):heatmapData.heatmap.length-1;if(!heatmapData.heatmap[selectedYear-1]){$('#heatmapPrevious').css('display','none');}else{$('#heatmapPrevious').css('display','block');$('#heatmapPrevious').attr('data-year',selectedYear-1);}
if(!heatmapData.heatmap[selectedYear+1]){$('#heatmapNext').css('display','none');}else{$('#heatmapNext').css('display','block');$('#heatmapNext').attr('data-year',selectedYear+1);}
var data=heatmapData.heatmap[selectedYear];var helper=[];for(var i=0;i<data.length;i++){for(var j=0;j<data[i].length;j++){var date=new Date(Date.UTC(selectedYear,i,j+1));var month=date.getMonth()+1<10?'0'+(date.getMonth()+1):date.getMonth()+1
var day=date.getDate()<10?'0'+date.getDate():date.getDate()
helper.push({date:date,value:data[i][j],selector:date.getFullYear()+'-'+month+'-'+day})}}
createHeatmap($('#heatmapContainer'),helper,'date');var mediaData=d3.nest().entries(heatmapData.media).map(function(d){return{name:d.mediah,value:d.count,selector:d.media,filter:d.filter}});createPieChart($('#pieChartContainer'),mediaData,'media',150);var bucketData=d3.nest().entries(heatmapData.bucket).map(function(d){return{name:d.bucketh,value:d.count,selector:d.bucket,filter:d.filter}});createPieChart($('#pieChartContainer2'),bucketData,'bucket',150);};appendSearchResultPB=function appendSearchResultPB(data){var servicesContainer=$("#services_container");servicesContainer.show();$.each(data,function(key,val){if(typeof ultimateArray[val.selectortypeh]=="undefined"||!(ultimateArray[val.selectortypeh]instanceof Array)){ultimateArray[val.selectortypeh]=[];}
for(var k in ultimateArray){if(ultimateArray.hasOwnProperty(k)){foundResPB++;if(val.selectortypeh==k){var e={selectorvalue:val.selectorvalue,selectorvalueh:val.selectorvalueh};ultimateArray[val.selectortypeh].push(e);}}}
searchRes++;});for(var k in ultimateArray){ultimateArray[k].sort(function(a,b){return a.selectorvalue.localeCompare(b.selectorvalue);});var x=k.replace(/ /g,"_").replace(/\//g,"");$("#"+x).html("");if(ultimateArray[k].length>0&&$("#"+x).length==0){servicesContainer.append('<div class="delme row">'+
'<div class="row-fluid">'+
'<b>'+
k+' ('+
'<span id="'+x+'_stats">'+
ultimateArray[k].length+
'</span>'+
')'+
'</b>'+
'<div '+
'class="PBBlock" '+
'id="'+x+'" '+
'>'+
'</div>'+
'</div>'+
'</div>');}
$("#"+x+"_stats").html(ultimateArray[k].length);$.each(ultimateArray[k],function(key,val){$("#"+x).append("<div class='col-xs-6 col-sm-3 col-md-3 col-lg-3 PBItem'>"+
"<a class='show show2 blankInlineSearchPB' href='#' data-to-search='"+val.selectorvalue.trim()+"' data-lookup='1'>"+
val.selectorvalueh+
"</a>"+
"</div>");});}};onResultsErrorPB=function(pl_ID){return function(jqXhr){try{var obj=$.parseJSON(jqXhr.responseText);if(!obj){if(foundResPB<1){changeSearchMessagePB('No results found.')}}else{appendSearchResult(pl_ID,obj,"",false,0);}}catch(err){if(foundResPB<1){changeSearchMessagePB('API Error.')}else{changeSearchMessagePB('API Error.')}}
search2.data("requestRunning",false);$("#spinner").hide();autoTogglePBButton();};};generateStats=function generateStats(data,pl_ID){var el=$("#found_media_stats");el.html("");$.each(data.media,function(index,value){var count=this.count>=1000?'1000+':this.count;if(index==data.media.length-1){el.append(""+count+" "+this.mediah+"");}else{el.append(""+count+" "+this.mediah+", ");}});if(el.html()==''){el.html("0 results");}
el.parent().parent().show();};onStatsError=function onStatsError(pl_ID){return function(jqXhr){try{heatmapData=$.parseJSON(jqXhr.responseText);generateStats(heatmapData);}catch(err){}};};appendSearchError=function appendSearchError(message){$('#tab').append('<pre class="alert alert-danger">'+message+'</pre>');$('#spinner').hide();};appendSearchResult=function appendSearchResult(pl_ID,data,searchTerm,groupUp,statistics,callback){$.each(data,function(key,val){if(key=="records"&&!!val){foundRes++;$.each(val,function(key2,val2){searchResArr[val2.systemid]=val2;relArr=[];if(val2.instore===true){kleissner.apiCalls.getDetails(0,val2.storageid,val2.systemid,0,searchTerm,val2.type,"",val2.size,val2.bucket,"","",val2.randomid,val2.media);}
var name=!!val2.name?val2.name:"Untitled Document";var notFirst=false;var preTitle='';if($('#g_'+val2.group).length<=0&&$('#g_'+val2.group).find('.collapseButton').length<=0){notFirst=true;}else{preTitle='<a href="#" class="collapseButton plus"><i class="fa fa-plus-square-o"></i></a>';}
var h4_tooltip=val2.media!=30?'<h4 class="h4_tooltip col-xs-12 col-sm-8">'+
preTitle+
'<a data-id="'+val2.systemid+'" head-id="1" class="view_details" style="cursor:pointer;">'+name+'</a>'+
'</h4>':'';var dateDiv=''+
(val2.accesslevel==4?'<span class="preview_label" data-toggle="tooltip" data-original-title="Your license only allows to preview this document." data-placement="left">PREVIEW</span>':'');if(!!val2.date){dateDiv+='<span>'+dateConvert(val2.date)+'</span>';}
var dateDivRow=val2.media==30?'<div class="col-12 row nomargin nopadding info_row">'+dateDiv+'</div>':'<div class="col-xs-12 col-sm-4 row nopadding nomargin info_row" style="height:30px;">'+dateDiv+'</div>';var transform='<div class="itemResult col-xs-12" id="div_'+val2.randomid+'">'+
'<div class="search-result col-12">'+
'<div class="prevResult col-12 nomargin nopadding row"  style="font-family: Arial;">'+
h4_tooltip+
dateDivRow+
'</div>'+
'<div class="row col-12 nopadding nomargin result '+(!groupUp||notFirst||val2.media==30?'':'hidden')+'">'+
'<div class="col-12 pre-details nopadding nomargin" id="d_'+val2.randomid+'">'+
'</div>'+
'</div>'+
'</div>'+
'</div>';if(pl_ID!=currentSearchId){$("#spinner").show();return;}
if(!groupUp||val2.media==30||!val2.group||$('#g_'+val2.group).length<=0){var idHelper=!!groupUp&&val2.media!=30&&!!val2.group?'g_'+val2.group:'';$('#tab').append('<div id="'+idHelper+'" class="searchDataContainer table-row raw">'+transform+'</div>');}else{if($('#g_'+val2.group).find('.collapseAllButton').length<=0){if($('#g_'+val2.group).find('.itemResult').length>=2){$('#g_'+val2.group+' > div:first-child').after('<a href="#" class="collapseAllButton plus">Ungroup all</a>');}}
$('#g_'+val2.group).append(transform).addClass('hasGroup');if(!initialSearch){$('#newResultsGroupedPopup').css({visibility:'visible',opacity:'1'});}}});}});if(statistics==1){kleissner.localApiCalls.checkStats(pl_ID,callback);}else{if(!!callback){callback();}}};changeSearchMessage=function changeSearchMessage(message,paddingBottom){var tab=$('#tab');if(paddingBottom!=0){$("#nmr").remove();}else{tab.html("");}
tab.append("<div style='margin-bottom: "+paddingBottom+"px;' id='nmr'>"+message+"</div>");};changeSearchMessagePB=function changeSearchMessagePB(message){if(!!message&&message.length>0){$('.delme.error').html(message).show();}else{$('.delme.error').html('').hide();}};onResultsError=function(pl_ID){return function(jqXhr){try{var obj=$.parseJSON(jqXhr.responseText);if(!obj){if(foundRes<1){changeSearchMessage('No results found.',0)}}else{appendSearchResult(pl_ID,obj,"");}}catch(err){if(foundRes<1){changeSearchMessage('API Error.',0)}else{changeSearchMessage('API Error.',20)}}
search2.data("requestRunning",false);$("#spinner").hide();};};onSearch=function onSearch(){toggleHeader(false);};onSearchEnd=function onSearchEnd(){toggleSearch(false);$("#tab").html("");};onSearchError=function onSearchError(){$("#tab").html("");toggleHeader(true);hideWarnings();toggleDownload(false);};init=function(){};$(document).ready(init);return{onToggleFilter:onToggleFilter,autoTogglePBButton:autoTogglePBButton,hideWarnings:hideWarnings,toggleDownload:toggleDownload,toggleHeader:toggleHeader,toggleSearch:toggleSearch,refreshGraphs:refreshGraphs,appendSearchResultPB:appendSearchResultPB,onResultsErrorPB:onResultsErrorPB,generateStats:generateStats,onStatsError:onStatsError,appendSearchError:appendSearchError,appendSearchResult:appendSearchResult,changeSearchMessage:changeSearchMessage,changeSearchMessagePB:changeSearchMessagePB,onResultsError:onResultsError,onSearch:onSearch,onSearchEnd:onSearchEnd,onSearchError:onSearchError};}($));var TxtType=function initTxtType(el,toRotate,period){this.toRotate=toRotate;this.el=el;this.loopNum=0;this.period=parseInt(period,10)||2000;this.txt='';this.tick();this.isDeleting=0;};TxtType.prototype.tick=function TxtTypeTick(){if(this.isDeleting!=2){var i=this.loopNum%this.toRotate.length;var fullTxt=this.toRotate[i];if(this.isDeleting===1){this.txt=fullTxt.substr(0,this.txt.length-1);}else{this.txt=unicodeSubstring(fullTxt,0,this.txt.length+1);}
if(this.txt.length!=fullTxt.length){$('.type_headline').html(this.txt+'|');}else{$('.type_headline').html(this.txt);}
var that=this;var delta=150;if(this.isDeleting){delta=100;}
if(this.isDeleting===0&&this.txt===fullTxt){delta=this.period;this.isDeleting=3;}else if(this.isDeleting===1&&this.txt===''){this.isDeleting=0;this.loopNum++;delta=500;}else if(this.isDeleting===3){this.isDeleting=1
delta=2500;}
txttypetimer=setTimeout(function(){that.tick();},delta);}};TxtType.prototype.stop=function(){$('.type_headline').html('');this.isDeleting=2;clearTimeout(txttypetimer);};TxtType.prototype.start=function(){this.isDeleting=0;this.tick();};$(document).ready(function(){search2=$(this);$(window).ready(function(){var elements=document.getElementsByClassName('typewrite');for(var i=0;i<elements.length;i++){var toRotate=elements[i].getAttribute('data-type');var period=elements[i].getAttribute('data-period');if(!!toRotate){typer=new TxtType(elements[i],JSON.parse(toRotate),period);}}
$('<style type="text/css">.typewrite > .wrap { border-right: 0.08em solid #fff } </style>').prependTo("body");var location=window.location.pathname.split("/").pop();if(location.indexOf('index')>-1||location==''){$('#Term').prop('readonly',false).focus();iscr=0;var tab=$('#tab');$(window).scroll(function(){if(isSearching){if(window.innerHeight+document.documentElement.scrollTop>=document.body.offsetHeight&&iscr<1){iscr++;kleissner.apiCalls.checkResults(tab.attr("search-id"),tab.attr("search-term"),10,Number(tab.attr("groupUp")),tab.attr("alt-term"),tab.attr("alt-termh"),0);}}
clearTimeout($.data(this,'scroller'));$.data(this,'scroller',setTimeout(function(){setTimeout(function(){$('#newResultsGroupedPopup').css({visibility:'hidden',opacity:'0'});},1500);},1000))});}else if(location.indexOf('account')>-1){kleissner.localApiCalls.getOrders();kleissner.localApiCalls.getAlerts();}else if(location.indexOf('assistant')>-1){var melania=new VirtualAssistant({selector:'virtualAssistant',url:API_URL,key:API_KEY});}else if(location.indexOf('tools')>-1){$('#emailVerifyTable').bootstrapTable({data:[]}).show();$('#selectorExtractTable').bootstrapTable({data:[]}).show();$('#magicSelectorTable').bootstrapTable({data:[]}).show();$('#geoIPTable').bootstrapTable({data:[]}).show();$('#dropzoneUpload').fileDrop({onFileRead:function(fileCollection){kleissner.tools.fileOnUpload(fileCollection[0].name,fileCollection[0].data);},decodebase64:true});$('#selectorUpload').fileDrop({onFileRead:function(fileCollection){kleissner.tools.selectorExtract(fileCollection[0].name,fileCollection[0].data.substr(fileCollection[0].data.indexOf(',')+1));},decodebase64:true});$('#pdfUpload').fileDrop({onFileRead:function(fileCollection){kleissner.tools.pdfImagesExtract(fileCollection[0].name,fileCollection[0].data.substr(fileCollection[0].data.indexOf(',')+1));},decodebase64:true});$('#magicUpload').fileDrop({onFileRead:function(fileCollection){kleissner.tools.magicOnUpload(fileCollection[0].name,fileCollection[0].data);},decodebase64:true});}
$("body").tooltip({selector:'[data-toggle="tooltip"]',placement:"top",container:"body",trigger:"hover",boundary:"window"});$("#date_from").datetimepicker({format:"YYYY-MM-DD",inline:true,maxDate:moment().endOf('d'),useCurrent:false}).on('dp.change',function(event){var date=!!event.date?event.date.format('YYYY-MM-DD'):null;$('#date_from_label').html(date);$('#date_from_hidden').val(date);$('#date_to').data('DateTimePicker').minDate(!!date?date:false);var date_from=$('#date_from_hidden').val();var date_to=$('#date_to_hidden').val();$('#date_range').remove();if(!!date_from&&!!date_to){if(date_from>date_to){$('#date_to').data('DateTimePicker').date(date_from);}else{$('#adv_settings > div').append(AdvFilterHTML('date_range',null,"adv_date",date_from+' - '+date_to));}}});$("#date_to").datetimepicker({format:"YYYY-MM-DD",inline:true,maxDate:moment().endOf('d'),useCurrent:false}).on('dp.change',function(event){var date=!!event.date?event.date.format('YYYY-MM-DD'):null;$('#date_to_label').html(date);$('#date_to_hidden').val(date);var date_from=$('#date_from_hidden').val();var date_to=$('#date_to_hidden').val();$('#date_range').remove();if(!!date_from&&!!date_to){$('#adv_settings > div').append(AdvFilterHTML('date_range',null,"adv_date",date_from+' - '+date_to));}});window.onpopstate=onPopState;window.onpopstate(window.history);if(!window.history.state||(!window.history.state.form&&!window.history.state.viewID&&!window.history.state.tab)){if(typeof GET_URL_PARAMETER("s")!=="undefined"&&GET_URL_PARAMETER("s")!==""){$('#indexAd').hide();var searchTerm=GET_URL_PARAMETER("s");if(document.referrer=="https://inteltechniques.com/osint/iframe/email.search.html"){if(searchTerm.substr(searchTerm.length-5)=='.html'){searchTerm=searchTerm.substr(0,searchTerm.length-5);}}
var datefrom=GET_URL_PARAMETER("df");var dateto=GET_URL_PARAMETER("dt");var targetservice=!!GET_URL_PARAMETER("b")?GET_URL_PARAMETER("b").split(','):undefined;var sortorder=GET_URL_PARAMETER("so");var mediafilter=GET_URL_PARAMETER("m");var phonebookfilter=GET_URL_PARAMETER("pb");var checkGroup=GET_URL_PARAMETER("g");$("#Term").val(searchTerm);if(!!datefrom){$('#date_from').data('DateTimePicker').date(datefrom);}else{$('#date_from').data('DateTimePicker').date(null);$('#services_container').hide().find('.delme').not('.error').remove();}
if(!!dateto){$('#date_to').data('DateTimePicker').date(dateto);}else{$('#date_to').data('DateTimePicker').date(null);}
$.each(targetservice,function(key,value){var el=$('input[name="targetservice[]"][value="'+value+'"]');var id=el.attr('id');var text=$('label[for="'+id+'"]').html();el.prop('checked','checked');$('#adv_filters > div').append(AdvFilterHTML(null,id,"adv_categories",text));});if(!!sortorder){var sort=$('input[name="sort_order"][value="'+sortorder+'"]');sort.prop('checked','checked');$('#sort_label .adv_filter_text').html('Sorted by '+$('label[for="'+sort.attr('id')+'"]').html());}
if(!!mediafilter){$('#mediaFilter').val(mediafilter);if(mediafilter!=0){$('#adv_settings > div').append(AdvFilterHTML('media_label','mediaFilter',"adv_misc",'Media Filter: '+$('#mediaFilter').find('option:selected').text()));}}
if(!!phonebookfilter){$('#checkPhonebook').click();kleissner.apiCalls.getSearchIdPB($('#searchData').serializeJSON(),searchTerm);}
if(!!checkGroup){$('#checkGroup').click();}
kleissner.frontendChanges.onSearch();kleissner.apiCalls.getSearchId($('#searchData').serializeJSON(),searchTerm,0,null);kleissner.frontendChanges.onSearchEnd();}else if(typeof GET_URL_PARAMETER('did')!=='undefined'&&GET_URL_PARAMETER("did")!==""){$('#indexAd').hide();var id=GET_URL_PARAMETER("did");$('#Term').val(id);kleissner.frontendChanges.onSearch();var formData=$("#searchData").serializeJSON();kleissner.apiCalls.getSearchId(formData,formData['Term'],0,null,function(){$("#detail_overlay").css("display","none");$("#data_full").html('<div style="text-align: center;margin-top: 250px;">Loading Data ...</div>');window.history.replaceState({page:'index',form:formData},null,'/?s='+id);kleissner.eventHandler.viewDetailsOnClick($('.view_details').attr('data-id'));});kleissner.frontendChanges.onSearchEnd();}else if(typeof GET_URL_PARAMETER("pid")!=="undefined"){$('#indexAd').hide();$("#Term").val(GET_URL_PARAMETER("pid"));$('#checkPhonebook').attr('checked',true);kleissner.eventHandler.onInlineSearchPB(GET_URL_PARAMETER("pid"));}else if(typeof GET_URL_PARAMETER("tab")!=='undefined'){var tab=GET_URL_PARAMETER("tab");$('.nav2 > a').removeClass('active');$('.nav2[data-tab="'+tab+'"] > a').addClass('active');$('.tab2').removeClass('active');$('#'+GET_URL_PARAMETER("tab")).addClass('active');window.history.replaceState({page:'tools',tab:tab},null,'/tools?tab='+tab);}}});});function onPopState(event){if(!!event.state){var page=event.state.page;if(page=='index'){$('#media_label').remove();var search=function search(callback){$('#indexAd').hide();aborted=false;var form=event.state.form;if(!form['Term']){kleissner.frontendChanges.onSearchError();return;}
$('#Term').val(form['Term']);if(!!form['date_from']){$('#date_from').data('DateTimePicker').date(form['date_from']);}else{$('#date_from').data('DateTimePicker').date(null);$('#services_container').hide().find('.delme').not('.error').remove();}
if(!!form['date_to']){$('#date_to').data('DateTimePicker').date(form['date_to']);}else{$('#date_to').data('DateTimePicker').date(null);}
$.each(form['targetservice'],function(key,value){var el=$('input[name="targetservice[]"][value="'+value+'"]');var id=el.attr('id');var text=$('label[for="'+id+'"]').html();el.prop('checked','checked');$('#adv_filters > div').append(AdvFilterHTML(null,id,"adv_categories",text));});var sort=$('input[name="sort_order"][value="'+form["sort_order"]+'"]');sort.prop('checked','checked');$('#sort_label').html('Sorted by '+$('label[for="'+sort.attr('id')+'"]').html());$('#mediaFilter').val(form['mediaFilter']);if(form['mediaFilter']!=0){$('#adv_settings > div').append(AdvFilterHTML("media_label","mediaFilter",'adv_misc','Media Filter: '+$('#mediaFilter').find('option:selected').text()));}
kleissner.frontendChanges.onSearch();if(!!form['checkPhonebook']){$('#checkPhonebook').prop('checked','checked');$('#adv_settings > div').append(AdvFilterHTML("phonebook_label","checkPhonebook",'adv_misc',"Search Phonebook"));kleissner.apiCalls.getSearchIdPB(form,form['Term']);}else{$('#checkPhonebook').prop('checked',false);}
if(!!form['checkGroup']){$('#checkGroup').prop('checked','checked');$('#adv_settings > div').append(AdvFilterHTML("group_label","checkGroup",'adv_misc',"Group Similar Results"));}else{$('#checkGroup').prop('checked',false);}
kleissner.apiCalls.getSearchId(form,form['Term'],0,null,callback);kleissner.frontendChanges.onSearchEnd();};if(!!event.state.viewID){currentHistoryIndex=window.history.length;$("#detail_overlay").css("display","none");$("#data_full").html('<div style="text-align: center;margin-top: 250px;">Loading Data ...</div>');if($('#tab').html()==''){search(function(){window.onpopstate=function(){kleissner.eventHandler.closeDetailOnClick();window.onpopstate=onPopState;};kleissner.apiCalls.getViewDetails(GET_URL_PARAMETER("did"));});}else{window.onpopstate=function(){kleissner.eventHandler.closeDetailOnClick();window.onpopstate=onPopState;};kleissner.apiCalls.getViewDetails(GET_URL_PARAMETER("did"));}}else{$('#indexAd').show();$('#detail_overlay').modal('hide');$('#data_full').html('');$('#dataFullSearch').val('').trigger('keyup');window.onpopstate=onPopState;$('#clear_filters').trigger('click');if(!!event.state.form){typer.stop();search();}else{if(!!xhr){xhr.abort();aborted=true;}
$("#spinner").hide();kleissner.frontendChanges.toggleHeader(true);kleissner.frontendChanges.hideWarnings();kleissner.frontendChanges.toggleSearch(true);kleissner.frontendChanges.toggleDownload(false);$('#services_container').hide().find('.delme').not('.error').remove();$('#detail_overlay').modal('hide');$('#data_full').html('');$('#dataFullSearch').val('').trigger('keyup');$('#Term').val('');$('#tab').html('');kleissner.localHandler.openChartModalOnClick(true);$('#search_stats').hide();isSearching=false;typer.start();}}}else if(page=='account'){$('.nav1 > a').removeClass('active');$('.nav1[data-tab="'+event.state.tab+'"] > a').addClass('active');$('.tab1').removeClass('active');$('#'+event.state.tab).addClass('active');if(!!event.state.update){$(event.state.update).addClass('in');}}else if(page=='tools'){$('.nav2 > a').removeClass('active');$('.nav2[data-tab="'+event.state.tab+'"] > a').addClass('active');$('.tab2').removeClass('active');$('#'+event.state.tab).addClass('active');if(!!event.state.update){$(event.state.update).addClass('in');}}}};function AdvFilterHTML(id,data_remove,data_tab,text)
{var html_tag='<div class="adv_filter"';if(id!==null){html_tag+=' id="'+id+'"';}
if(data_remove!==null){html_tag+=' data-remove="'+data_remove+'"';}
if(data_tab!==null){html_tag+=' data-tab="'+data_tab+'"';}
return html_tag+'><span class="adv_filter_text">'+text+'</span><i class="fa fa-times adv_remove"></i></div>';};